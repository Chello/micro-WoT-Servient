{"ssid":"Rachelli-net","password":"3eKLtrdFwfQXgpv!","portserver":"80","portsocket":"81","portcoap":"5683","libraries":["HTTPClient.h"],"constants":[],"globals":[{"name":"GREENLED","type":"const int","value":"12"},{"name":"REDLED","type":"const int","value":"33"},{"name":"HTTPUrl","type":"const char*","value":"http://192.168.1.106/bike-rack/events/hasParkChanged"}],"setup":"// property0_value[0] = false;\n// property0_value[1] = false;\n// property0_value[2] = false;\n// This statement will declare pin 22 as digital output \npinMode(GREENLED, OUTPUT);\npinMode(REDLED, OUTPUT);\n// This statement will declare pin 15 as digital input \n// pinMode(SENSOR0, INPUT);\n// pinMode(SENSOR1, INPUT);\n","loop":"HTTPClient http1;\n\nhttp1.begin(HTTPUrl);\n\nint httpResponseCode = http1.GET();\nif (httpResponseCode>0) {\n  String payload = http1.getString();\n  \n  DynamicJsonDocument doc(200);\n  Serial.println(payload);\n  deserializeJson(doc, payload);\n  // extract the values\n  JsonObject obj = doc.as<JsonObject>();\n  JsonArray array = obj[\"parks\"];\n  bool tot = true;\n  for(JsonVariant v : array) {\n    bool vas = v.as<bool>();\n    tot &= vas;\n  }\n  if (tot) {\n    Serial.println(\"Rosso\");\n    digitalWrite(GREENLED, LOW);\n    digitalWrite(REDLED, HIGH);\n  } else {\n    Serial.println(\"Verde\");\n    digitalWrite(GREENLED, HIGH);\n    digitalWrite(REDLED, LOW);\n  }\n}\n// http1.end();","actionFunctions":[{"source":"cli","name":"statusChanged","body":"return;","output":{},"input":[{"name":"resp","type":"string"}]}],"eventConditions":[{"condition":"true","actions":["statusChanged"]}]}
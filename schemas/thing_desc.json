{
  "title": "Thing",
  "type": "object",
  "id": "root",
  "required": [
    "title",
    "id",
    "forms",
    "@context",
    "security",
    "securityDefinitions",
    "useWS"
  ],
  "properties": {
    "title": {
      "type": "string",
      "title": "Thing title",
      "description": "Title of the Thing",
      "minLength": 2
    },
    "id": {
      "type": "string",
      "title": "Thing URI",
      "description": "URI of the Thing",
      "minLength": 2
    },
    "@context": {
      "title": "Thing context",
      "type": "array",
      "format": "table",
      "description": "JSON schema(s) for Thing",
      "items": {
        "type": "string",
        "properties": {
          "name": "thing_schema"
        }
      },
      "options": {
        "collapsed": true
      },
      "default": [
        "https://www.w3.org/2019/wot/td/v1"
      ]
    },
    "security": {
      "type": "string",
      "default": "nosec_sc",
      "options": {
        "hidden": true
      }
    },
    "securityDefinitions": {
      "type": "object",
      "required": [
        "nosec_sc"
      ],
      "options": {
        "hidden": true
      },
      "properties": {
        "nosec_sc": {
          "type": "object",
          "required": [
            "scheme"
          ],
          "properties": {
            "scheme": {
              "type": "string",
              "default": "nosec"
            }
          }
        }
      }
    },
    "forms": {
      "type": "array",
      "title": "Operations",
      "format": "table",
      "minItems": 1,
      "maxItems": 1,
      "items": {
        "title": "",
        "type": "object",
        "required": [
          "op",
          "contentType",
          "href"
        ],
        "properties": {
          "contentType": {
            "const": "application/json",
            "default": "application/json",
            "options": {
              "hidden": true
            }
          },
          "href": {
            "default": "",
            "const": "",
            "options": {
              "hidden": true
            }
          },
          "op": {
            "type": "array",
            "format": "categories",
            "name": "operations",
            "description": "Operation supported by the Thing",
            "uniqueItems": true,
            "minItems": 1,
            "items": {
              "type": "string",
              "enum": [
                "readallproperties",
                "writeallproperties",
                "readmultipleproperties",
                "writemultipleproperties"
              ]
            }
          }
        }
      }
    },
    "useWS": {
      "type": "boolean",
      "title": "Is Thing using WebSocket?",
      "format": "checkbox",
      "default": true
    },
    "description": {
      "type": "string",
      "title": "Description",
      "description": "Thing description"
    },
    "version": {
      "type": "string",
      "title": "Version",
      "description": "Thing version"
    },
    "support": {
      "type": "string",
      "title": "Thing support URI"
    },
    "base": {
      "type": "string",
      "title": "Thing base URI"
    },
    "created": {
      "type": "string",
      "format": "date",
      "title": "Thing creation date"
    },
    "modified": {
      "type": "string",
      "format": "date",
      "title": "Thing modification date"
    },
    "links": {
      "options": {
        "collapsed": true
      },
      "type": "array",
      "title": "Links",
      "headerTemplate": "Link {{i}}",
      "items": {
        "type": "object",
        "properties": {
          "href": {
            "type": "string",
            "title": "Link Href"
          },
          "type": {
            "type": "string",
            "title": "Link type"
          },
          "rel": {
            "type": "string",
            "title": "Link relation type"
          },
          "anchor": {
            "type": "string",
            "title": "Link anchor"
          }
        }
      }
    },
    "properties": {
      "type": "array",
      "title": "Thing properties",
      "options": {
        "collapsed": true
      },
      "items": {
        "type": "object",
        "title": "Thing property",
        "headerTemplate": "{{self.propertyName}}",
        "required": [
          "propertyName",
          "type",
          "forms",
          "useWS",
          "observable",
          "readOnly",
          "writeOnly"
        ],
        "properties": {
          "propertyName": {
            "type": "string",
            "title": "Property name"
          },
          "forms": {
            "type": "array",
            "format": "table",
            "title": "Operations",
            "minItems": 1,
            "maxItems": 1,

            "items": {
              "title": "Operations",
              "type": "object",
              "required": [
                "op",
                "contentType",
                "href"
              ],
              "properties": {
                "contentType": {
                  "const": "application/json",
                  "default": "application/json",
                  "options": {
                    "hidden": true
                  }
                },
                "href": {
                  "default": "",
                  "const": "",
                  "options": {
                    "hidden": true
                  }
                },
                "op": {
                  "type": "array",
                  "format": "categories",
                  "name": "operations",
                  "description": "Operation supported by the property",
                  "uniqueItems": true,
                  "minItems": 1,
                  "items": {
                    "type": "string",
                    "enum": [
                      "readproperty",
                      "writeproperty"
                    ]
                  }
                }
              }
            }
          },
          "useWS": {
            "type": "boolean",
            "title": "Is property using WebSocket?",
            "format": "checkbox",
            "default": true
          },
          "type": {
            "title": "Property type",
            "description": "Type of property",
            "type": "string",
            "enum": [
              "boolean",
              "integer",
              "number",
              "string",
              "object",
              "array",
              "null"
            ]
          },
          "@type": {
            "type": "array",
            "title": "Property meta-type",
            "items": {
              "type": "string"
            }
          },
          "observable": {
            "title": "Is property observable?",
            "type": "boolean",
            "default": false
          },
          "readOnly": {
            "title": "Is property read-only?",
            "type": "boolean",
            "default": true
          },
          "writeOnly": {
            "title": "Is property write-only?",
            "type": "boolean",
            "default": true
          },
          "title": {
            "title": "Property title",
            "type": "string"
          },
          "description": {
            "title": "Property description",
            "type": "string"
          }
        }
      }
    },
    "actions": {
      "type": "array",
      "name": "actions",
      "id": "actions",
      "title": "Thing actions",
      "options": {
        "collapsed": true
      },
      "items": {
        "type": "object",
        "headerTemplate": "{{self.actionName}}",
        "title": "Thing action",
        "required": [
          "actionName",
          "forms",
          "useWS",
          "body",
          "safe",
          "idempotent"
        ],
        "properties": {
          "actionName": {
            "type": "string",
            "title": "Action name"
          },
          "forms": {
            "type": "array",
            "format": "table",
            "minItems": 1,
            "maxItems": 1,
            "uniqueItems": true,
            "options": {
              "hidden": true
            },
            "items": {
              "title": "Operations",
              "type": "object",
              "required": [
                "op",
                "contentType",
                "href"
              ],
              "properties": {
                "contentType": {
                  "const": "application/json",
                  "default": "application/json",
                  "options": {
                    "hidden": true
                  }
                },
                "href": {
                  "default": "",
                  "const": "",
                  "options": {
                    "hidden": true
                  }
                },
                "op": {
                  "default": "invokeaction",
                  "const": "invokeaction",
                  "options": {
                    "hidden": true
                  }
                }
              }
            }
          },
          "useWS": {
            "type": "boolean",
            "title": "Is property using WebSocket?",
            "format": "checkbox",
            "default": true
          },
          "input": {
            "type": "array",
            "title": "Inputs",
            "required": [
              "inputName",
              "type"
            ],
            "items": {
              "title": "Input",
              "type": "object",
              "required": [
                "inputName",
                "type"
              ],
              "properties": {
                "inputName": {
                  "title": "Input name",
                  "type": "string"
                },
                "type": {
                  "title": "Action type",
                  "description": "Type of action",
                  "type": "string",
                  "enum": [
                    "boolean",
                    "integer",
                    "number",
                    "string",
                    "object",
                    "array",
                    "null"
                  ]
                }
              }
            }
          },
          "output": {
            "type": "object",
            "title": "Output",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "title": "Output type",
                "enum": [
                  "boolean",
                  "integer",
                  "number",
                  "string",
                  "object",
                  "array",
                  "null"
                ]
              }
            }
          },
          "body": {
            "title": "Action function",
            "type": "string",
            "format": "textarea",
            "description": "Body of the function for current action"
          },
          "safe": {
            "title": "Is function safe?",
            "type": "boolean"
          },
          "idempotent": {
            "title": "Is function idempotent?",
            "type": "boolean"
          },
          "@type": {
            "type": "array",
            "title": "Action meta types",
            "items": {
              "title":"Specify meta-type",
              "type": "string"
            }
          },
          "title": {
            "title":"Action title",
            "type": "string"
          },
          "description": {
            "title": "Action description",
            "type": "string"
          }
        }
      }
    },
    "events": {
      "type": "array",
      "name": "events",
      "title": "Thing events",
      "items": {
        "required": [
          "eventName",
          "condition",
          "actionsTriggered",
          "forms",
          "useWS"
        ],
        "headerTemplate": "{{self.eventName}}",
        "type": "object",
        "title": "Thing event",
        "properties": {
          "eventName": {
            "title": "Event name",
            "type": "string"
          },
          "forms": {
            "type": "array",
            "title": "Operations",
            "format": "table",
            "minItems": 1,
            "maxItems": 1,
            "items": {
              "title": "",
              "type": "object",
              "required": [
                "op",
                "contentType",
                "href",
                "useWS"
              ],
              "properties": {
                "contentType": {
                  "const": "application/json",
                  "default": "application/json",
                  "options": {
                    "hidden": true
                  }
                },
                "href": {
                  "default": "",
                  "const": "",
                  "options": {
                    "hidden": true
                  }
                },
                "op": {
                  "type": "array",
                  "format": "categories",
                  "name": "operations",
                  "description": "Operation supported by the event",
                  "uniqueItems": true,
                  "minItems": 1,
                  "items": {
                    "type": "string",
                    "enum": [
                      "subscribeevent",
                      "unsubscribeevent"
                    ]
                  }
                }
              }
            }
          },
          "useWS": {
            "type": "boolean",
            "title": "Is event using WebSocket?",
            "format": "checkbox",
            "default": true
          },
          "actionsTriggered": {
            "type": "array",
            "title": "Triggers for the event",
            
            "items": {
              "type": "string",
              "title": "Trigger for this event",
              "description": "Specify which action will be triggered for this event. You can specify more triggers but you cannot duplicate them.",
              "watch": {
                "actionAssoc": "root.actions"
              },
              "enumSource": [
                {
                  "source": "actionAssoc",
                  "value": "{{item.actionName}}"
                }
              ]
            }
          },
          "condition": {
            "title": "Condition when event will occur",
            "type": "string",
            "description": "Must be a boolean statement. Must NOT contain 'if' or brackets"
          },
          "subscription": {
            "type": "array",
            "title": "Event subscription schema",
            "uniqueItems": true,
            "items": {
              "type": "object",
              "required":["subscriptionName", "type", "value"],
              "properties": {
                "subscriptionName": {
                  "title": "Subscription name",
                  "type": "string"
                },
                "type": {
                  "type": "string",
                  "title": "Subscription type",
                  "enum": [
                    "boolean",
                    "integer",
                    "number",
                    "string",
                    "object",
                    "array",
                    "null"
                  ]
                },
                "value": {
                  "title": "Value for subscription schema",
                  "type": "string"
                }
              }
            }
          },
          "data": {
            "type": "array",
            "title": "Event data schema",
            "uniqueItems": true,
            "items": {
              "type": "object",
              "required":["dataName", "type", "value"],
              "properties": {
                "dataName": {
                  "title": "Event data name",
                  "type": "string"
                },
                "type": {
                  "type": "string",
                  "title": "Event subscription type",
                  "enum": [
                    "boolean",
                    "integer",
                    "number",
                    "string",
                    "object",
                    "array",
                    "null"
                  ]
                },
                "value": {
                  "title": "Value for data schema",
                  "type": "string"
                }
              }
            }
          },
          "cancellation": {
            "type": "array",
            "title": "Event cancellation schema",
            "uniqueItems": true,
            "items": {
              "type": "object",
              "required":["cancellationName", "type", "value"],
              "properties": {
                "cancellationName": {
                  "title": "Event cancellation name",
                  "type": "string"
                },
                "type": {
                  "type": "string",
                  "title": "Event cancellation type",
                  "enum": [
                    "boolean",
                    "integer",
                    "number",
                    "string",
                    "object",
                    "array",
                    "null"
                  ]
                },
                "value": {
                  "title": "Value for cancellation schema",
                  "type": "string"
                }
              }
            }
          },
          "@type": {
            "type": "array",
            "title": "Property meta-type",
            "items": {
              "type": "string"
            }
          },
          "title": {
            "title": "Event title",
            "type": "string"
          },
          "description": {
            "title": "Event description",
            "type": "string"
          }
        }
      }
    }
  }
}
{"ssid":"Rachelli-net","password":"3eKLtrdFwfQXgpv!","portserver":"80","portsocket":"81","portcoap":"5683","libraries":["HTTPClient.h"],"constants":[],"globals":[{"name":"GREENLED","type":"const int","value":"12"},{"name":"REDLED","type":"const int","value":"33"},{"name":"HTTPUrl","type":"const char*","value":"http://192.168.1.106/bike-rack/events/hasParkChanged"}],"setup":"// property0_value[0] = false;\n// property0_value[1] = false;\n// property0_value[2] = false;\n// This statement will declare pin 22 as digital output \npinMode(GREENLED, OUTPUT);\npinMode(REDLED, OUTPUT);\n// This statement will declare pin 15 as digital input \n// pinMode(SENSOR0, INPUT);\n// pinMode(SENSOR1, INPUT);\n","loop":"Serial.println(\"Speriamo0\");\nHTTPClient http;\nSerial.println(\"Speriamo0.1\");\n\nhttp.begin(HTTPUrl);\nSerial.println(\"Speriamo0.2\");\n\nint httpResponseCode = http.GET();\nSerial.println(\"Speriamo1\");\nif (httpResponseCode>0) {\n  String payload = http.getString();\n  \n  DynamicJsonDocument doc(150);\n  // http.end();\n  Serial.println(\"Speriamo2\");\n  Serial.println(payload);\n  deserializeJson(doc, payload);\n  // extract the values\n  JsonObject obj = doc.as<JsonObject>();\n  JsonArray array = obj[\"parks\"];\n  bool tot = true;\n  for(JsonVariant v : array) {\n    Serial.println(\"Speriamo3-4\");\n    bool vas = v.as<bool>();\n    tot = tot && vas;\n  }\n  Serial.println(\"Speriamo5\");\n  if (tot) {\n    Serial.println(\"Rosso\");\n    digitalWrite(GREENLED, LOW);\n    digitalWrite(REDLED, HIGH);   \n  } else {\n    Serial.println(\"Verde\");\n    digitalWrite(GREENLED, HIGH);\n    digitalWrite(REDLED, LOW);\n  }\n  Serial.println(\"Speriamo6\");\n  doc.clear();\n}\nSerial.println(\"Speriamo7\");\n// http.end();\nSerial.println(\"Speriamo8\");","actionFunctions":[{"source":"cli","name":"statusChanged","body":"return;","output":{},"input":[{"name":"resp","type":"string"}]}],"eventConditions":[{"condition":"true","actions":["statusChanged"]}]}